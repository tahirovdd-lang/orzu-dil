<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>ORZU-DIL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Lobster&family=Montserrat:wght@500;700;800&display=swap" rel="stylesheet">

<style>
:root{
  /* ‚úÖ Variant D ‚Äî Premium Uzbek (dark + gold) */
  --bg:#0B0B0C;
  --surface:#141416;
  --surface-2:#101012;
  --text:#F4F2EA;
  --muted: rgba(244,242,234,.72);

  --gold:#D8B04C;
  --gold-2:#B88922;
  --header:#0B0B0C;

  /* keep old var names used across layout */
  --emerald: var(--gold);
  --terracotta: var(--gold);
  --green: var(--gold);
  --meat: var(--gold);

  --stroke: rgba(216,176,76,.18);
  --stroke-strong: rgba(216,176,76,.32);
  --inner: rgba(255,255,255,.06);
  --shadow: rgba(0,0,0,.40);
  --shadow-strong: rgba(0,0,0,.62);

  --r-lg:24px;
  --r-md:22px;
  --r-pill:28px;

  /* ‚úÖ Telegram viewport vars */
  --app-h: 100vh;

  /* ‚úÖ –Ω–∏–∂–Ω—è—è sticky –ø–∞–Ω–µ–ª—å (–±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è JS) */
  --sticky-h: 92px;
}

body[data-theme="dark"]{
  --bg:#070708;
  --surface:#121214;
  --surface-2:#0D0D0F;
  --text:#F7F4EA;
  --muted: rgba(247,244,234,.72);

  --stroke: rgba(216,176,76,.20);
  --stroke-strong: rgba(216,176,76,.36);
  --inner: rgba(255,255,255,.06);

  --shadow: rgba(0,0,0,.46);
  --shadow-strong: rgba(0,0,0,.68);

  --header:#070708;
  color:var(--text);
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;margin:0;padding:0;}

body{
  font-family:'Montserrat',sans-serif;
  -webkit-text-size-adjust:100%;
  background:
    radial-gradient(1200px 700px at 20% -10%, rgba(216,176,76,.08), transparent 55%),
    radial-gradient(900px 600px at 95% 0%, rgba(216,176,76,.06), transparent 50%),
    var(--bg);
  color:var(--text);

  min-height:100vh;
  min-height:100dvh;
  min-height: var(--tg-viewport-height, 100vh);
  min-height: var(--app-h, 100vh);

  overflow-x:hidden;
  -webkit-overflow-scrolling:touch;

  padding-bottom: calc(var(--sticky-h, 92px) + 18px + var(--tg-safe-area-inset-bottom, 0px) + env(safe-area-inset-bottom, 0px));
}

.header{
  padding:16px 12px 26px;
  background:linear-gradient(180deg, rgba(0,0,0,.40), rgba(0,0,0,0)) , var(--header);
  color:var(--text);
  box-shadow:0 12px 28px var(--shadow-strong);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  text-align:center;
  border-bottom: 1px solid rgba(216,176,76,.75);
}

/* ‚úÖ –ª–æ–≥–æ—Ç–∏–ø —á—É—Ç—å –±–æ–ª—å—à–µ */
.logo-frame{
  position:absolute;
  left:12px;
  width:70px;
  height:70px;
  border-radius:18px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid rgba(216,176,76,.30);
  box-shadow:0 14px 26px rgba(0,0,0,.45), 0 0 0 1px rgba(216,176,76,.08) inset;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
.logo-frame img{
  width:50px;
  height:50px;
  object-fit:contain;
  filter: drop-shadow(0 10px 18px rgba(0,0,0,.55));
}

.brand-title{
  font-family: "Times New Roman", Georgia, serif;
  font-size:34px;
  letter-spacing:.6px;
  font-weight:700;
}
.brand-sub{font-weight:800;font-size:15px;opacity:.86;}

.brand-phone{position:relative; z-index:50; pointer-events:auto;}
.brand-phone a{
  color:var(--text);
  text-decoration:none;
  font-size:15px;
  font-weight:700;
  position:relative;
  z-index:51;
  pointer-events:auto;
  cursor:pointer;
  opacity:.92;
}

.menu-btn{
  position:absolute;
  right:14px;
  top:12px;
  width:42px;
  height:42px;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  z-index:80;

  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid rgba(216,176,76,.40);
  box-shadow: 0 12px 24px rgba(0,0,0,.40), 0 0 0 1px rgba(216,176,76,.08) inset;
  transition:.15s;
}
.menu-btn:active{transform:scale(.97);}
.burger{width:22px;height:16px;position:relative;}
.burger span{
  position:absolute;left:0;right:0;
  height:3px;border-radius:10px;
  background:rgba(244,242,234,.92);
  opacity:.95;
}
.burger span:nth-child(1){top:0;}
.burger span:nth-child(2){top:6.5px;}
.burger span:nth-child(3){bottom:0;}

/* ‚úÖ‚úÖ FIX: geo –∏ search –±–æ–ª—å—à–µ –Ω–µ –Ω–∞–µ–∑–∂–∞—é—Ç –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ */
.geo-btn{
  position:absolute;
  right:14px;
  top:60px;            /* –ø–æ–¥ –±—É—Ä–≥–µ—Ä–æ–º */
  width:36px;
  height:36px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  z-index:75;

  color:var(--text);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid rgba(216,176,76,.40);
  box-shadow: 0 12px 24px rgba(0,0,0,.40), 0 0 0 1px rgba(216,176,76,.08) inset;
  transition:.15s;
}
.geo-btn:active{transform:scale(.97);}

.search-btn{
  position:absolute;
  right:60px;          /* ‚úÖ —Å–¥–≤–∏–Ω—É–ª–∏ –≤–ª–µ–≤–æ */
  top:60px;            /* ‚úÖ –Ω–∞ –æ–¥–Ω–æ–π –ª–∏–Ω–∏–∏ —Å geo */
  width:36px;
  height:36px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  z-index:74;

  color:var(--text);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  border:1px solid rgba(216,176,76,.40);
  box-shadow: 0 12px 24px rgba(0,0,0,.40), 0 0 0 1px rgba(216,176,76,.08) inset;
  transition:.15s;
}
.search-btn:active{transform:scale(.97);}

.langs,.types,.payments{
  display:flex;
  gap:12px;
  padding:12px;
  justify-content:center;
}

.btn{
  padding:12px 20px;
  border-radius:var(--r-pill);
  font-weight:800;
  min-width:120px;
  text-align:center;
  cursor:pointer;
  transition:.15s;

  border:1px solid rgba(216,176,76,.22);
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: 0 12px 26px rgba(0,0,0,.42);
  color:var(--text);
}
.btn:active{transform:scale(.98);}
.btn.active{
  background: linear-gradient(135deg, var(--gold), var(--gold-2));
  color:#141416;
  border:1px solid rgba(255,255,255,.16);
  box-shadow: 0 14px 30px rgba(216,176,76,.18), 0 12px 26px rgba(0,0,0,.35);
}

.input{
  margin:8px auto;
  display:block;
  padding:14px;
  width:85%;
  border-radius:var(--r-md);
  font-size:15px;

  border:1px solid rgba(216,176,76,.20);
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: 0 12px 26px rgba(0,0,0,.42);
  outline:none;
  transition:.15s;
  color:var(--text);
}
.input:focus{
  border-color: rgba(216,176,76,.38);
  box-shadow: 0 16px 34px rgba(0,0,0,.52), 0 0 0 2px rgba(216,176,76,.08);
}

.categories{
  display:flex;
  gap:12px;
  padding:14px;
  overflow-x:auto;
  scroll-behavior:smooth;
}

.products{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
  padding:12px;
}

.card{
  border-radius:var(--r-lg);
  padding:12px;
  text-align:center;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(216,176,76,.18);
  box-shadow:
    0 16px 34px rgba(0,0,0,.55),
    0 0 0 1px rgba(216,176,76,.06) inset,
    0 0 22px rgba(216,176,76,.06);
  transition:.15s;
  color:var(--text);
}
.card:active{transform:scale(.99);}

.img{
  height:140px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:6px;
  border-radius:18px;
  background:
    radial-gradient(220px 140px at 50% 60%, rgba(216,176,76,.10), transparent 60%),
    rgba(0,0,0,.18);
  border:1px solid rgba(216,176,76,.12);
  overflow:hidden;
}
.img img{
  max-width:125px;
  max-height:125px;
  width:auto;
  height:auto;
  object-fit:contain;
  opacity:1;
  transform:scale(1.05);
  transition:.15s;
  filter: saturate(1.15) contrast(1.06) brightness(1.06) drop-shadow(0 12px 18px rgba(0,0,0,.55));
}
.card:active .img img{transform:scale(1.12);}

.item-name{
  margin-top:2px;
  padding:0 6px;
  font-weight:900;
  line-height:1.15;
  min-height:34px;
  display:flex;
  align-items:center;
  justify-content:center;
  word-break:break-word;
}

.price{
  font-weight:900;
  color:var(--gold);
  margin-top:6px;
  text-shadow: 0 10px 18px rgba(0,0,0,.45);
}
.price small{font-weight:800;opacity:.78;margin-left:4px;}

.counter{display:flex;justify-content:center;gap:10px;margin-top:8px;align-items:center;}
.counter button{
  width:32px;
  height:32px;
  border-radius:50%;
  cursor:pointer;

  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(135deg, var(--gold), var(--gold-2));
  color:#141416;
  font-size:16px;
  font-weight:900;
  box-shadow:0 14px 30px rgba(216,176,76,.16), 0 12px 24px rgba(0,0,0,.35);
  transition:.15s;
}
.counter button:active{transform:scale(.96);}

.cart{
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  margin:12px;
  padding:16px;
  border-radius:var(--r-lg);
  border:1px solid rgba(216,176,76,.20);
  box-shadow: 0 16px 34px rgba(0,0,0,.55);
  color:var(--text);
  scroll-margin-bottom: calc(var(--sticky-h, 92px) + 22px);
}

textarea.input{height:90px;}

/* ‚úÖ‚úÖ FIX: –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ –ù–ï –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç—Å—è sticky –∫–æ—Ä–∑–∏–Ω–æ–π:
   –¥–µ–ª–∞–µ–º –∑–∞–ø–∞—Å —Å–Ω–∏–∑—É –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ä–∑–∏–Ω—ã –∏ —á—É—Ç—å –º–µ–Ω—å—à–µ margin —É –∫–Ω–æ–ø–∫–∏ */
.cart{
  padding-bottom: calc(16px + var(--sticky-h, 92px) + 18px);
}

/* –∫–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ */
.order-btn{
  width:100%;
  padding:18px;
  margin-top:12px;
  border-radius:var(--r-lg);
  cursor:pointer;
  color:#141416;
  font-size:17px;
  font-weight:900;

  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(135deg,var(--gold), var(--gold-2));
  box-shadow: 0 16px 36px rgba(216,176,76,.16), 0 16px 34px rgba(0,0,0,.45);
  transition:.15s;

  position:relative;
  z-index: 20;
}
.order-btn:active{transform:scale(.99);}

.popup{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:.3s;}
.popup.show{opacity:1;pointer-events:auto;}
.popup-box{
  background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
  padding:26px;
  border-radius:var(--r-lg);
  text-align:center;
  font-weight:800;
  border:1px solid rgba(216,176,76,.25);
  box-shadow: 0 22px 46px rgba(0,0,0,.60), 0 0 24px rgba(216,176,76,.10);
  color:var(--text);
}

.search-wrap{
  width:85%;
  margin:8px auto;
  position:relative;
  display:none;
  z-index:70;
}
.search-wrap.show{display:block;}
.search-wrap input{width:100%;margin:0;padding-right:44px;}
.search-clear{
  position:absolute;
  right:10px;
  top:50%;
  transform:translateY(-50%);
  width:30px;
  height:30px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;

  border:1px solid rgba(216,176,76,.22);
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  box-shadow: 0 12px 26px rgba(0,0,0,.42);
  transition:.15s;
  color:var(--text);
}
.search-clear:active{transform:translateY(-50%) scale(.96);}

.search-title{
  width:85%;
  margin:10px auto 0;
  font-weight:900;
  opacity:.92;
  display:none;
  z-index:70;
  position:relative;
  color:var(--text);
}
.search-title.show{display:block;}

mark{background:rgba(216,176,76,.22);padding:0 .12em;border-radius:6px;color:var(--text);}

.quick-filters{
  display:flex;
  gap:10px;
  padding:0 12px 10px;
  overflow-x:auto;
}
.qbtn{
  border:1px solid rgba(216,176,76,.22);
  background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: 0 12px 26px rgba(0,0,0,.42);
  border-radius:999px;
  padding:10px 14px;
  font-weight:900;
  cursor:pointer;
  white-space:nowrap;
  transition:.15s;
  color:var(--text);
}
.qbtn:active{transform:scale(.98);}

.popular-wrap{width:100%;padding:4px 12px 6px;}
.popular-title{width:100%;font-weight:900;padding:8px 2px 10px;display:flex;align-items:center;gap:8px;color:var(--text);}
.popular-row{display:flex;gap:12px;overflow-x:auto;padding:2px 2px 10px;}
.pop-card{
  min-width:150px;
  border-radius:var(--r-lg);
  padding:10px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(216,176,76,.18);
  box-shadow: 0 16px 34px rgba(0,0,0,.55), 0 0 22px rgba(216,176,76,.06);
  cursor:pointer;
  transition:.15s;
  position:relative;
  color:var(--text);
}
.pop-card:active{transform:scale(.99);}
.pop-img{
  height:74px;
  border-radius:18px;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(180px 90px at 50% 60%, rgba(216,176,76,.10), transparent 60%), rgba(0,0,0,.18);
  border:1px solid rgba(216,176,76,.12);
}
.pop-img img{width:100%;height:100%;object-fit:cover; filter:saturate(1.15) contrast(1.06) brightness(1.06);}
.pop-name{font-weight:900;margin-top:8px;}
.pop-price{font-weight:900;color:var(--gold);margin-top:4px;}
.pop-badge{position:absolute;left:10px;top:10px;font-size:18px;pointer-events:none;}

.pop-counter{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  margin-top:8px;
}
.pop-counter button{
  width:30px;
  height:30px;
  border-radius:50%;
  cursor:pointer;

  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(135deg, var(--gold), var(--gold-2));
  color:#141416;
  font-size:16px;
  font-weight:900;
  box-shadow:0 14px 30px rgba(216,176,76,.16), 0 12px 24px rgba(0,0,0,.35);
  transition:.15s;
}
.pop-counter button:active{transform:scale(.96);}
.pop-counter span{font-weight:900; min-width:18px; text-align:center;}

/* –Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
.sticky-checkout{
  position:fixed;
  left:0; right:0; bottom:0;
  padding:10px 12px;
  background:rgba(7,7,8,.74);
  backdrop-filter: blur(12px);
  z-index:999;
  border-top:1px solid rgba(216,176,76,.26);
  padding-bottom: calc(10px + var(--tg-safe-area-inset-bottom, 0px) + env(safe-area-inset-bottom, 0px));
}
.sticky-inner{
  max-width:520px;
  margin:0 auto;
  border-radius:18px;
  padding:10px 12px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(216,176,76,.18);
  box-shadow: 0 16px 34px rgba(0,0,0,.55);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.sticky-sum{font-weight:900;line-height:1.1;color:var(--text);}
.sticky-sum small{display:block;font-weight:800;opacity:.78;margin-top:2px;}
.sticky-btn{
  padding:12px 14px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.18);
  background:linear-gradient(135deg,var(--gold), var(--gold-2));
  color:#141416;
  font-weight:900;
  cursor:pointer;
  box-shadow: 0 16px 36px rgba(216,176,76,.16), 0 16px 34px rgba(0,0,0,.45);
  transition:.15s;
  white-space:nowrap;
}
.sticky-btn:active{transform:scale(.99);}

/* –º–µ–Ω—é sheet */
.menu-backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.58);
  opacity:0;
  pointer-events:none;
  transition:.18s;
  z-index:1000;
}
.menu-backdrop.show{opacity:1;pointer-events:auto;}

.menu-sheet{
  position:fixed;
  left:0; right:0;
  bottom:-100%;
  background:rgba(10,10,11,.96);
  border-top-left-radius:22px;
  border-top-right-radius:22px;
  border:1px solid rgba(216,176,76,.22);
  box-shadow:0 22px 46px rgba(0,0,0,.70);
  transition:.22s;
  z-index:1010;
  padding:10px 12px 14px;
  padding-bottom: calc(14px + var(--tg-safe-area-inset-bottom, 0px) + env(safe-area-inset-bottom, 0px));
}
.menu-sheet.show{bottom:0;}
.menu-handle{
  width:44px;height:5px;border-radius:999px;
  background:rgba(216,176,76,.32);
  margin:6px auto 10px;
}
.menu-head{
  display:flex;align-items:center;justify-content:space-between;
  padding:2px 4px 10px;
}
.menu-head b{font-size:16px;color:var(--text);}
.menu-close{
  width:38px;height:38px;border:none;border-radius:12px;
  background:transparent;
  cursor:pointer;
  font-size:22px;
  line-height:1;
  color:rgba(244,242,234,.86);
}

.menu-list{display:flex;flex-direction:column;gap:8px;}
.menu-item{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:12px 12px;
  border-radius:16px;
  border:1px solid rgba(216,176,76,.18);
  background:rgba(255,255,255,.04);
  cursor:pointer;
  text-decoration:none;
  color:var(--text);
}
.menu-left{display:flex;align-items:center;gap:10px;min-width:0;}
.menu-ic{
  width:30px;height:30px;border-radius:12px;
  display:flex;align-items:center;justify-content:center;
  background:rgba(216,176,76,.14);
  flex:0 0 auto;
}
.menu-txt{display:flex;flex-direction:column;min-width:0;}
.menu-name{font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.menu-sub{font-size:12px;opacity:.78;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px;}
.menu-right{opacity:.65;font-weight:900;}

.about-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.60);
  display:none;
  z-index:1100;
  padding:18px 14px;
}
.about-modal.show{display:block;}
.about-card{
  max-width:680px;
  margin:0 auto;
  background:rgba(10,10,11,.96);
  border:1px solid rgba(216,176,76,.22);
  border-radius:22px;
  box-shadow:0 22px 46px rgba(0,0,0,.70);
  padding:14px 14px 12px;
  color:var(--text);
}
.about-head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:6px;}
.about-head b{font-size:16px;}
.about-body{font-size:14px;line-height:1.45;}
.about-muted{opacity:.78;}

@media (max-width:360px){
  .brand-title{font-size:30px;}
  .logo-frame{width:66px;height:66px;}
  .logo-frame img{width:48px;height:48px;}
}
</style>
</head>

<body data-theme="dark">

<div class="header">
  <div class="logo-frame">
    <img src="logo.png" onerror="this.src='logo.png'">
  </div>

  <div>
    <div class="brand-title">ORZU-DIL</div>
    <div class="brand-sub">Milliy Taomlar</div>
    <div class="brand-phone">
      <a href="tel:+998906065606" onclick="callPhone(event)">+998 90 606 56 06</a>
    </div>
  </div>

  <div class="menu-btn" onclick="openTopMenu()" title="–ú–µ–Ω—é">
    <div class="burger"><span></span><span></span><span></span></div>
  </div>

  <div class="search-btn" onclick="toggleSearch()">üîç</div>
  <div class="geo-btn" onclick="requestGeo()" title="–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è">üìç</div>
</div>

<div class="menu-backdrop" id="menuBackdrop" onclick="closeTopMenu()"></div>

<div class="menu-sheet" id="menuSheet">
  <div class="menu-handle"></div>
  <div class="menu-head">
    <b>–ú–µ–Ω—é</b>
    <button class="menu-close" onclick="closeTopMenu()">√ó</button>
  </div>

  <div class="menu-list">
    <div class="menu-item" onclick="toggleReviewWidget()" role="button">
      <div class="menu-left">
        <div class="menu-ic">‚≠ê</div>
        <div class="menu-txt">
          <div class="menu-name">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</div>
          <div class="menu-sub">–Ø–Ω–¥–µ–∫—Å —Ä–µ–π—Ç–∏–Ω–≥ / –æ—Ç–∑—ã–≤—ã</div>
        </div>
      </div>
      <div class="menu-right">‚Ä∫</div>
    </div>

    <div id="reviewWidgetWrap" style="display:none; padding:6px 4px 10px;">
      <div style="border:1px solid rgba(216,176,76,.22); border-radius:16px; overflow:hidden; background:#fff; padding:10px; display:flex; justify-content:center;">
        <iframe
          src="https://yandex.ru/sprav/widget/rating-badge/11046753996?type=rating"
          width="150"
          height="50"
          frameborder="0"
          style="border:0; display:block;"
        ></iframe>
      </div>
      <div style="text-align:center; font-size:12px; opacity:.80; margin-top:6px; color:var(--text);">
        –ï—Å–ª–∏ –≤–∏–¥–∂–µ—Ç –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è –≤ Telegram ‚Äî –æ—Ç–∫—Ä–æ–π—Ç–µ –æ—Ç–∑—ã–≤—ã —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ.
      </div>
      <div style="display:flex; justify-content:center; margin-top:8px;">
        <button class="btn" style="min-width:auto; padding:10px 14px;" onclick="openYandexReviews(event)">–û—Ç–∫—Ä—ã—Ç—å –æ—Ç–∑—ã–≤—ã</button>
      </div>
    </div>

    <a class="menu-item" href="tel:+998906065606" onclick="closeTopMenu(); callPhone(event)">
      <div class="menu-left">
        <div class="menu-ic">üìû</div>
        <div class="menu-txt">
          <div class="menu-name">–ü–æ–∑–≤–æ–Ω–∏—Ç—å</div>
          <div class="menu-sub">+998 90 606 56 06</div>
        </div>
      </div>
      <div class="menu-right">‚Ä∫</div>
    </a>

    <a class="menu-item" href="#" onclick="openInstagram(event)">
      <div class="menu-left">
        <div class="menu-ic" aria-hidden="true">
          <svg width="18" height="18" viewBox="0 0 24 24" style="display:block;">
            <path fill="currentColor" d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm10 2H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3zm-5 4.3A5.7 5.7 0 1 1 6.3 14 5.7 5.7 0 0 1 12 8.3zm0 2A3.7 3.7 0 1 0 15.7 14 3.7 3.7 0 0 0 12 10.3zM18 6.7a1 1 0 1 1-1 1 1 1 0 0 1 1-1z"/>
          </svg>
        </div>
        <div class="menu-txt">
          <div class="menu-name">@ORZU_DIL</div>
          <div class="menu-sub">–û—Ç–∫—Ä—ã—Ç—å Instagram</div>
        </div>
      </div>
      <div class="menu-right">‚Ä∫</div>
    </a>

    <div class="menu-item" onclick="openAbout()" role="button">
      <div class="menu-left">
        <div class="menu-ic">‚ÑπÔ∏è</div>
        <div class="menu-txt">
          <div class="menu-name">–û –Ω–∞—Å</div>
          <div class="menu-sub">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ ORZU-DIL</div>
        </div>
      </div>
      <div class="menu-right">‚Ä∫</div>
    </div>
  </div>
</div>

<div class="about-modal" id="aboutModal" onclick="aboutBackdropClick(event)">
  <div class="about-card">
    <div class="about-head">
      <b>–û –Ω–∞—Å</b>
      <button class="menu-close" onclick="closeAbout()">√ó</button>
    </div>
    <div class="about-body">
      <b>ORZU-DIL</b> ‚Äî –∫–∞—Ñ–µ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫—É—Ö–Ω–∏.<br>
      <span class="about-muted">–î–æ–±–∞–≤—å —Å—é–¥–∞ —Ç–µ–∫—Å—Ç: –∞–¥—Ä–µ—Å, –≥—Ä–∞—Ñ–∏–∫, –¥–æ—Å—Ç–∞–≤–∫–∞, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, –∏ —Ç.–¥.</span>
    </div>
  </div>
</div>

<div class="search-title" id="searchTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</div>
<div class="search-wrap" id="searchWrap">
  <input id="searchInput" class="input" placeholder="–ü–æ–∏—Å–∫ –±–ª—é–¥–∞..." oninput="searchProducts()" onkeydown="onSearchKey(event)">
  <div class="search-clear" onclick="clearSearch()" title="–û—á–∏—Å—Ç–∏—Ç—å">‚úñ</div>
</div>

<div class="langs">
  <button class="btn" onclick="setLang('ru',this)">RU</button>
  <button class="btn active" onclick="setLang('uz',this)">UZ</button>
  <button class="btn" onclick="setLang('en',this)">EN</button>
</div>

<div class="popular-wrap" id="popularWrap">
  <div class="popular-title" id="popularTitle">üî• –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</div>
  <div class="popular-row" id="popularRow"></div>
</div>

<!-- ‚úÖ –ù–∏–∂–µ –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ: —É–±—Ä–∞–ª–∏ –±–ª–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π (tabs) -->
<!-- <div class="categories" id="cats"></div> -->

<div class="quick-filters" id="quickFilters"></div>

<div class="types">
  <button class="btn" id="btnDelivery" onclick="setType('delivery',this)"></button>
  <button class="btn active" id="btnPickup" onclick="setType('pickup',this)"></button>
</div>

<input id="address" class="input">
<input id="phone" class="input">

<div class="products" id="products"></div>

<div class="cart" id="cartBox">
  <b id="cartTitle"></b>:
  <span id="total">0</span> —Å—É–º
  <div id="deliveryLine" style="margin-top:8px; font-weight:900; color:var(--gold); display:none;">
    –î–æ—Å—Ç–∞–≤–∫–∞: <span id="deliveryFee">15 000</span> —Å—É–º
  </div>

  <textarea id="comment" class="input"></textarea>

  <div class="payments">
    <button class="btn active" id="payCash" onclick="setPayment('cash')"></button>
    <button class="btn" id="payClick" onclick="setPayment('click')"></button>
  </div>

  <button class="order-btn" id="orderBtn" onclick="sendOrder()"></button>
</div>

<div class="popup" id="popup"><div class="popup-box">‚úÖ –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!</div></div>

<div class="sticky-checkout" id="stickyCheckout">
  <div class="sticky-inner">
    <div class="sticky-sum">
      <span id="stickyTotal">0</span> <small>—Å—É–º</small>
    </div>
    <button class="sticky-btn" onclick="openCart()" id="stickyCartBtn">–ö–æ—Ä–∑–∏–Ω–∞</button>
  </div>
</div>

<script>
Telegram.WebApp.ready();

try{
  Telegram.WebApp.expand();
  Telegram.WebApp.disableVerticalSwipes?.();
} catch(_){}

function setAppHeight(){
  const h = (window.Telegram && Telegram.WebApp && Telegram.WebApp.viewportHeight)
    ? Telegram.WebApp.viewportHeight
    : window.innerHeight;

  document.documentElement.style.setProperty('--app-h', h + 'px');

  try{
    if(window.Telegram && Telegram.WebApp){
      if (Telegram.WebApp.viewportHeight) {
        document.documentElement.style.setProperty('--tg-viewport-height', Telegram.WebApp.viewportHeight + 'px');
      }
      const safeBottom = Telegram.WebApp.safeAreaInset?.bottom;
      if (safeBottom != null){
        document.documentElement.style.setProperty('--tg-safe-area-inset-bottom', safeBottom + 'px');
      }
    }
  }catch(_){}
}

function setStickyHeight(){
  const el = document.getElementById('stickyCheckout');
  if(!el) return;
  const h = Math.ceil(el.getBoundingClientRect().height || el.offsetHeight || 92);
  document.documentElement.style.setProperty('--sticky-h', h + 'px');
}

function refreshLayout(){
  setAppHeight();
  setStickyHeight();
}
refreshLayout();
window.addEventListener('resize', refreshLayout);
try{ Telegram.WebApp.onEvent('viewportChanged', refreshLayout); } catch(_){}

(function initTheme(){
  document.body.setAttribute('data-theme','dark');
  try{
    Telegram.WebApp.setHeaderColor?.('#070708');
    Telegram.WebApp.setBackgroundColor?.('#070708');
  }catch(_){}
})();

function callPhone(e){
  try{ e.preventDefault(); e.stopPropagation(); }catch(_){}
  const tel = "tel:+998906065606";
  try{
    if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openLink === "function"){
      Telegram.WebApp.openLink(tel);
      return;
    }
  }catch(_){}
  try{ window.location.href = tel; }catch(_){}
}

function requestGeo(){
  closeTopMenu();
  try{
    if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.requestLocation === 'function'){
      Telegram.WebApp.requestLocation((loc)=>{
        if(!loc){ alert('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –≤—ã–¥–∞–Ω–∞'); return; }
        const lat = loc.latitude, lon = loc.longitude;
        const url = `https://yandex.ru/maps/?ll=${lon}%2C${lat}&z=16`;
        try{ Telegram.WebApp.openLink(url); }catch(_){ window.open(url,'_blank'); }
      });
      return;
    }
  }catch(_){}

  if(!navigator.geolocation){
    alert('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
    return;
  }
  navigator.geolocation.getCurrentPosition((pos)=>{
    const lat = pos.coords.latitude;
    const lon = pos.coords.longitude;
    const url = `https://yandex.ru/maps/?ll=${lon}%2C${lat}&z=16`;
    try{
      if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openLink === "function"){
        Telegram.WebApp.openLink(url);
        return;
      }
    }catch(_){}
    window.open(url,'_blank');
  }, ()=>{
    alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é');
  }, {enableHighAccuracy:true, timeout:8000, maximumAge:0});
}

/* –º–µ–Ω—é */
function openTopMenu(){
  try{ closeSearch(); }catch(_){}
  document.getElementById('menuBackdrop').classList.add('show');
  document.getElementById('menuSheet').classList.add('show');
}
function closeTopMenu(){
  document.getElementById('menuBackdrop').classList.remove('show');
  document.getElementById('menuSheet').classList.remove('show');
}
function toggleReviewWidget(){
  const w = document.getElementById('reviewWidgetWrap');
  w.style.display = (w.style.display === 'none' || !w.style.display) ? 'block' : 'none';
}
function openYandexReviews(e){
  try{ e.preventDefault(); e.stopPropagation(); }catch(_){}
  const url = "https://yandex.ru/sprav/widget/rating-badge/11046753996?type=rating";
  try{
    if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openLink === "function"){
      Telegram.WebApp.openLink(url);
      return;
    }
  }catch(_){}
  window.open(url, "_blank");
}
function openInstagram(e){
  try{ e.preventDefault(); e.stopPropagation(); }catch(_){}
  const url = "https://www.instagram.com/orzu_dil/";
  closeTopMenu();
  try{
    if (window.Telegram && Telegram.WebApp && typeof Telegram.WebApp.openLink === "function"){
      Telegram.WebApp.openLink(url);
      return;
    }
  }catch(_){}
  window.open(url, "_blank");
}
function openAbout(){
  closeTopMenu();
  document.getElementById('aboutModal').classList.add('show');
}
function closeAbout(){
  document.getElementById('aboutModal').classList.remove('show');
}
function aboutBackdropClick(e){
  if(e.target && e.target.id === 'aboutModal') closeAbout();
}

/* ---------- DATA ---------- */
const tgUser = Telegram.WebApp.initDataUnsafe?.user || {};
const tg_username = tgUser.username || "";
const tg_first_name = tgUser.first_name || "";
const tg_id = tgUser.id || "";

/* ‚úÖ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: UZ + —Å–∞–º–æ–≤—ã–≤–æ–∑ */
let lang='uz', category='breakfast', type='pickup', payment='cash', cart={};

const DELIVERY_FEE = 15000;

const TEXT={
  ru:{delivery:'üöö –î–æ—Å—Ç–∞–≤–∫–∞',pickup:'üèÉ –°–∞–º–æ–≤—ã–≤–æ–∑',address:'üìç –ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',phone:'üìû –¢–µ–ª–µ—Ñ–æ–Ω',cart:'üõí –ö–æ—Ä–∑–∏–Ω–∞',order:'–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑',comment:'‚úçÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É',cash:'üíµ –ù–∞–ª–∏—á–Ω—ã–µ',click:'üí≥ CLICK',results:'–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞',popular:'üî• –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ',empty:'–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞—è',deliveryFee:'–î–æ—Å—Ç–∞–≤–∫–∞'},
  uz:{delivery:'üöö Yetkazish',pickup:'üèÉ Olib ketish',address:'üìç Manzil',phone:'üìû Telefon',cart:'üõí Savat',order:'Buyurtma berish',comment:'‚úçÔ∏è Izoh',cash:'üíµ Naqd',click:'üí≥ CLICK',results:'Qidiruv natijalari',popular:'üî• Ommabop',empty:"Savat bo‚Äòsh",deliveryFee:'Yetkazish'},
  en:{delivery:'üöö Delivery',pickup:'üèÉ Pickup',address:'üìç Address',phone:'üìû Phone',cart:'üõí Cart',order:'Place order',comment:'‚úçÔ∏è Comment',cash:'üíµ Cash',click:'üí≥ CLICK',results:'Search results',popular:'üî• Popular',empty:'Cart is empty',deliveryFee:'Delivery'}
};

const MENU = {
  breakfast:[
    {id:'pirozhki_myaso_1', p:7000,  img:'images/pirozhki_myaso_1.jpg', n:{ru:'–ü–∏—Ä–æ–∂–∫–∏ —Å –º—è—Å–æ–º 1—à—Ç', uz:'Pirojki go‚Äòshtli 1 dona', en:'Meat pie (1 pc)'}},
    {id:'pirozhki_kartoshka_1', p:5000, img:'images/pirozhki_kartoshka_1.jpg', n:{ru:'–ü–∏—Ä–æ–∂–∫–∏ —Å –∫–∞—Ä—Ç–æ—à–∫–æ–π 1—à—Ç', uz:'Pirojki kartoshkali 1 dona', en:'Potato pie (1 pc)'}},
    {id:'sosiska_v_teste_1', p:7000, img:'images/sosiska_v_teste_1.jpg', n:{ru:'–°–æ—Å–∏—Å–∫–∞ –≤ —Ç–µ—Å—Ç–µ 1—à—Ç', uz:'Sosiska xamirda 1 dona', en:'Sausage in dough (1 pc)'}},
    {id:'sosiski_zharenye_1', p:5000, img:'images/sosiski_zharenye_1.jpg', n:{ru:'–°–æ—Å–∏—Å–∫–∏ –∂–∞—Ä–µ–Ω–Ω—ã–µ 1—à—Ç', uz:'Qovurilgan sosiska 1 dona', en:'Fried sausage (1 pc)'}},
    {id:'yaytso_zharenoe_1', p:5000, img:'images/yaytso_zharenoe_1.jpg', n:{ru:'–Ø–π—Ü–æ –∂–∞—Ä–µ–Ω–Ω–æ–µ 1—à—Ç', uz:'Qovurilgan tuxum 1 dona', en:'Fried egg (1 pc)'}},
    {id:'yaytso_varenoe_1', p:5000, img:'images/yaytso_varenoe_1.jpg', n:{ru:'–Ø–π—Ü–æ –≤–∞—Ä–µ–Ω–æ–µ 1—à—Ç', uz:'Qaynatilgan tuxum 1 dona', en:'Boiled egg (1 pc)'}}
  ],
  first:[
    {id:'shurpa', p:45000, img:'images/shurpa.jpg', n:{ru:'–®—É—Ä–ø–∞', uz:"Sho'rva", en:'Shurpa'}},
    {id:'nahut_shurpo', p:50000, img:'images/nahut_shurpo.jpg', n:{ru:'–ù–∞—Ö—É—Ç –®—É—Ä–ø–æ', uz:"No'xat sho'rva", en:'Chickpea shurpa'}},
    {id:'lagman', p:45000, img:'images/lagman.jpg', n:{ru:'–õ–∞–≥–º–∞–Ω', uz:"Lag'mon", en:'Lagman'}},
    {id:'pelmeni_domashnie', p:45000, img:'images/pelmeni_domashnie.jpg', n:{ru:'–ü–µ–ª—å–º–µ–Ω–∏ –î–æ–º–∞—à–Ω–∏–µ', uz:'Uy chuchvara', en:'Homemade dumplings'}}
  ],
  second:[
    {id:'manty_1', p:10000, img:'images/manty_1.jpg', n:{ru:'–ú–∞–Ω—Ç—ã 1—à—Ç', uz:'Manti 1 dona', en:'Manti (1 pc)'}},
    {id:'grechka_s_kotletoy', p:45000, img:'images/grechka_s_kotletoy.jpg', n:{ru:'–ì—Ä–µ—á–∫–∞ —Å –∫–æ—Ç–ª–µ—Ç–æ–π', uz:"Grechka kotlet bilan", en:'Buckwheat with cutlet'}},
    {id:'tuy_kabob', p:50000, img:'images/tuy_kabob.jpg', n:{ru:'–¢—É–π –ö–∞–±–æ–±', uz:"To'y kabob", en:'Tuy kabob'}},
    {id:'golubtsy', p:45000, img:'images/golubtsy.jpg', n:{ru:'–ì–æ–ª—É–±—Ü—ã', uz:'Golubtsi', en:'Cabbage rolls'}},
    {id:'plov_05', p:50000, img:'images/plov_05.jpg', n:{ru:'–ü–ª–æ–≤ 0.5', uz:'Osh 0.5', en:'Plov 0.5'}},
    {id:'zhiz_biz_1kg', p:220000, img:'images/zhiz_biz_1kg.jpg', n:{ru:'–ñ–∏–∑-–ë–∏–∑ 1–∫–≥', uz:'Jiz-biz 1 kg', en:'Jiz-biz 1 kg'}},
    {id:'hasib_1kg', p:160000, img:'images/hasib_1kg.jpg', n:{ru:'–•–∞—Å–∏–± 1–∫–≥', uz:'Hasib 1 kg', en:'Hasib 1 kg'}}
  ],
  shashlik:[
    {id:'shashlik_molotyy', p:28000, img:'images/shashlik_molotyy.jpg', n:{ru:'–®–∞—à–ª—ã–∫ –ú–æ–ª–æ—Ç—ã–π', uz:'Qiyma shashlik', en:'Minced shashlik'}},
    {id:'kuskovoy_govyadina', p:30000, img:'images/kuskovoy_govyadina.jpg', n:{ru:'–ö—É—Å–∫–æ–≤–æ–π –ì–æ–≤—è–¥–∏–Ω–∞', uz:"Mol go'shti shashlik", en:'Beef shashlik'}},
    {id:'barani_rebryshki', p:35000, img:'images/barani_rebryshki.jpg', n:{ru:'–ë–∞—Ä–∞–Ω—å–∏ –†—ë–±—Ä—ã—à–∫–∏', uz:"Qo'y qovurg'a", en:'Lamb ribs'}}
  ],
  fish:[
    {id:'sazan_1kg', p:175000, img:'images/sazan_1kg.jpg', n:{ru:'–°–∞–∑–∞–Ω 1–∫–≥', uz:'Sazan 1 kg', en:'Carp 1 kg'}},
    {id:'belyy_amur_1kg', p:175000, img:'images/belyy_amur_1kg.jpg', n:{ru:'–ë–µ–ª—ã–π –ê–º—É—Ä 1–∫–≥', uz:'Oq amur 1 kg', en:'Grass carp 1 kg'}}
  ],
  salad:[
    {id:'svezhiy', p:10000, img:'images/svezhiy.jpg', n:{ru:'–°–≤–µ–∂–∏–π', uz:'Yangi salat', en:'Fresh salad'}},
    {id:'chakka_s_zelenyu', p:5000, img:'images/chakka_s_zelenyu.jpg', n:{ru:'–ß–∞–∫–∫–∞ —Å –∑–µ–ª–µ–Ω—å—é', uz:"Chakka ko'kat bilan", en:'Chakka with herbs'}},
    {id:'solenya', p:5000, img:'images/solenya.jpg', n:{ru:'–°–æ–ª–µ–Ω—å—è', uz:'Tuzlama', en:'Pickles'}},
    {id:'redka_s_chakkoy', p:5000, img:'images/redka_s_chakkoy.jpg', n:{ru:'–†–µ–¥—å–∫–∞ —Å –ß–∞–∫–∫–æ–π', uz:"Turp chakka bilan", en:'Radish with chakka'}}
  ],
  bread:[
    {id:'lepeshka_domashnyaya', p:8000, img:'images/lepeshka_domashnyaya.jpg', n:{ru:'–õ–µ–ø–µ—à–∫–∞ –î–æ–º–∞—à–Ω—è—è', uz:'Uy noni', en:'Homemade bread'}}
  ],
  drinks:[
    {id:'chai_chernyy_zelenyy', p:5000, img:'images/chai_chernyy_zelenyy.jpg', n:{ru:'–ß–∞–π –ß–µ—Ä–Ω—ã–π/–ó–µ–ª—ë–Ω—ã–π', uz:'Choy qora/yashil', en:'Tea black/green'}},
    {id:'chai_s_limonom', p:15000, img:'images/chai_s_limonom.jpg', n:{ru:'–ß–∞–π —Å –ª–∏–º–æ–Ω–æ–º', uz:'Limonli choy', en:'Tea with lemon'}},
    {id:'kofe_chernyy', p:8000, img:'images/kofe_chernyy.jpg', n:{ru:'–ö–æ—Ñ–µ –ß—ë—Ä–Ω—ã–π', uz:'Qora kofe', en:'Black coffee'}},
    {id:'kofe_3_1', p:8000, img:'images/kofe_3_1.jpg', n:{ru:'–ö–æ—Ñ–µ 3/1', uz:'Kofe 3/1', en:'Coffee 3-in-1'}},
    {id:'kakao', p:8000, img:'images/kakao.jpg', n:{ru:'–ö–∞–∫–∞–æ', uz:'Kakao', en:'Cocoa'}},
    {id:'kefir_200ml', p:5000, img:'images/kefir_200ml.jpg', n:{ru:'–ö–µ—Ñ–∏—Ä 200–º–ª', uz:'Kefir 200 ml', en:'Kefir 200 ml'}},

    {id:'cola_025', p:7000, img:'images/cola_025.jpg', n:{ru:'Coca Cola 0.25L', uz:'Coca Cola 0.25L', en:'Coca Cola 0.25L'}},
    {id:'fanta_025', p:7000, img:'images/fanta_025.jpg', n:{ru:'Fanta 0.25L', uz:'Fanta 0.25L', en:'Fanta 0.25L'}},
    {id:'cola_05', p:8000, img:'images/cola_05.jpg', n:{ru:'Coca Cola 0.5L', uz:'Coca Cola 0.5L', en:'Coca Cola 0.5L'}},
    {id:'fanta_05', p:8000, img:'images/fanta_05.jpg', n:{ru:'Fanta 0.5L', uz:'Fanta 0.5L', en:'Fanta 0.5L'}},
    {id:'cola_1', p:15000, img:'images/cola_1.jpg', n:{ru:'Coca Cola 1L', uz:'Coca Cola 1L', en:'Coca Cola 1L'}},
    {id:'fanta_1', p:15000, img:'images/fanta_1.jpg', n:{ru:'Fanta 1L', uz:'Fanta 1L', en:'Fanta 1L'}},
    {id:'cola_15', p:20000, img:'images/cola_15.jpg', n:{ru:'Coca Cola 1.5L', uz:'Coca Cola 1.5L', en:'Coca Cola 1.5L'}},
    {id:'fanta_15', p:20000, img:'images/fanta_15.jpg', n:{ru:'Fanta 1.5L', uz:'Fanta 1.5L', en:'Fanta 1.5L'}},

    {id:'borjomi_05', p:18000, img:'images/borjomi_05.jpg', n:{ru:'Borjomi 0.5L', uz:'Borjomi 0.5L', en:'Borjomi 0.5L'}},
    {id:'chortoq_05', p:18000, img:'images/chortoq_05.jpg', n:{ru:'Chortoq 0.5L', uz:'Chortoq 0.5L', en:'Chortoq 0.5L'}},

    {id:'sok_bliss_1l', p:15000, img:'images/sok_bliss_1l.jpg', n:{ru:'–°–æ–∫ Bliss 1L', uz:'Bliss sharbat 1L', en:'Bliss juice 1L'}},
    {id:'sok_sochnaya_dolina_1l', p:15000, img:'images/sok_sochnaya_dolina_1l.jpg', n:{ru:'–°–æ–∫ –°–æ—á–Ω–∞—è –î–æ–ª–∏–Ω–∞ 1L', uz:'Sochnaya Dolina sharbat 1L', en:'Sochnaya Dolina juice 1L'}},

    {id:'berg_05', p:5000, img:'images/berg_05.jpg', n:{ru:'–ú–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è –≤–æ–¥–∞ Berg 0.5L', uz:'Berg suv 0.5L', en:'Berg water 0.5L'}},
    {id:'berg_1', p:8000, img:'images/berg_1.jpg', n:{ru:'–ú–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è –≤–æ–¥–∞ Berg 1L', uz:'Berg suv 1L', en:'Berg water 1L'}},
    {id:'samarkand_15', p:10000, img:'images/samarkand_15.jpg', n:{ru:'–ì–∞–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–æ–¥–∞ SAMARKAND 1.5L', uz:'SAMARKAND gazli suv 1.5L', en:'SAMARKAND sparkling 1.5L'}},

    {id:'natakhtari_tarkhun_05', p:15000, img:'images/natakhtari_tarkhun_05.jpg', n:{ru:'–õ–∏–º–æ–Ω–∞–¥ –ù–∞—Ç–∞—Ö—Ç–∞—Ä–∏ –¢–∞—Ä—Ö—É–Ω 0.5L', uz:'Natakhtari Tarxun 0.5L', en:'Natakhtari Tarragon 0.5L'}},
    {id:'natakhtari_grusha_05', p:15000, img:'images/natakhtari_grusha_05.jpg', n:{ru:'–õ–∏–º–æ–Ω–∞–¥ –ù–∞—Ç–∞—Ö—Ç–∞—Ä–∏ –ì—Ä—É—à–∞ 0.5L', uz:'Natakhtari Nok 0.5L', en:'Natakhtari Pear 0.5L'}},
    {id:'natakhtari_saperavi_05', p:15000, img:'images/natakhtari_saperavi_05.jpg', n:{ru:'–õ–∏–º–æ–Ω–∞–¥ –ù–∞—Ç–∞—Ö—Ç–∞—Ä–∏ –°–∞–ø–µ—Ä–∞–≤–∏ 0.5L', uz:'Natakhtari Saperavi 0.5L', en:'Natakhtari Saperavi 0.5L'}},
    {id:'natakhtari_krem_soda_05', p:15000, img:'images/natakhtari_krem_soda_05.jpg', n:{ru:'–õ–∏–º–æ–Ω–∞–¥ –ù–∞—Ç–∞—Ö—Ç–∞—Ä–∏ –ö—Ä–µ–º –°–æ–¥–∞ 0.5L', uz:'Natakhtari Krem-soda 0.5L', en:'Natakhtari Cream soda 0.5L'}}
  ],
  preorder:[
    {id:'olive_1kg', p:180000, img:'images/olive_1kg.jpg', n:{ru:'–°–∞–ª–∞—Ç –û–ª–∏–≤—å–µ 1–∫–≥', uz:'Olivye salat 1 kg', en:'Olivier salad 1 kg'}},
    {id:'bichaki_s_travoy_1', p:10000, img:'images/bichaki_s_travoy_1.jpg', n:{ru:'–ë–∏—á–∞–∫–∏ —Å —Ç—Ä–∞–≤–æ–π 1—à—Ç', uz:"Bichaki ko'katli 1 dona", en:'Bichaki with herbs (1 pc)'}},
    {id:'somsa', p:12000, img:'images/somsa.jpg', n:{ru:'–°–æ–º—Å–∞', uz:'Somsa', en:'Somsa'}}
  ]
};

const POPULAR = ['plov_05','shurpa','lagman','tuy_kabob'];

const ITEM_INDEX = {};
for (const c in MENU){ MENU[c].forEach(it => { ITEM_INDEX[it.id] = it; }); }

function nameOf(id){
  const it = ITEM_INDEX[id];
  if(!it) return id;
  return (it.n && (it.n[lang] || it.n.ru)) || id;
}

function formatSum(x){
  const n = Number(x) || 0;
  return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,' ');
}
function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
function highlight(name, q){
  const n = escapeHtml(name);
  if(!q) return n;
  const idx = n.toLowerCase().indexOf(q.toLowerCase());
  if(idx === -1) return n;
  const before = n.slice(0, idx);
  const mid = n.slice(idx, idx + q.length);
  const after = n.slice(idx + q.length);
  return `${before}<mark>${mid}</mark>${after}`;
}

/* —ç–ª–µ–º–µ–Ω—Ç—ã */
const address = document.getElementById('address');
const phone = document.getElementById('phone');
const btnDelivery = document.getElementById('btnDelivery');
const btnPickup = document.getElementById('btnPickup');
const products = document.getElementById('products');
const total = document.getElementById('total');
const stickyTotal = document.getElementById('stickyTotal');
const cartTitle = document.getElementById('cartTitle');
const orderBtn = document.getElementById('orderBtn');
const comment = document.getElementById('comment');
const payCash = document.getElementById('payCash');
const payClick = document.getElementById('payClick');
const searchWrap = document.getElementById('searchWrap');
const searchTitle = document.getElementById('searchTitle');
const searchInput = document.getElementById('searchInput');
const quickFilters = document.getElementById('quickFilters');
const popularWrap = document.getElementById('popularWrap');
const popularTitle = document.getElementById('popularTitle');
const popularRow = document.getElementById('popularRow');
const cartBox = document.getElementById('cartBox');
const stickyCartBtn = document.getElementById('stickyCartBtn');
const popup = document.getElementById('popup');
const deliveryLine = document.getElementById('deliveryLine');
const deliveryFee = document.getElementById('deliveryFee');

function loadSaved(){
  const a = localStorage.getItem('orzu_dil_address') || '';
  const p = localStorage.getItem('orzu_dil_phone') || '';
  if(a && !address.value) address.value = a;
  if(p && !phone.value) phone.value = p;
}
function bindSave(){
  address.addEventListener('input', ()=>localStorage.setItem('orzu_dil_address', address.value));
  phone.addEventListener('input', ()=>localStorage.setItem('orzu_dil_phone', phone.value));
}

/* ‚úÖ –¥–æ—Å—Ç–∞–≤–∫–∞: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –∏ —Å—á–∏—Ç–∞–µ–º 15000 */
function getDeliveryFee(){
  return (type === 'delivery') ? DELIVERY_FEE : 0;
}

function updateTypeFields(){
  if(type === 'pickup'){
    address.style.display = 'none';
    address.value = '';
  }else{
    address.style.display = 'block';
  }

  const fee = getDeliveryFee();
  deliveryFee.innerText = formatSum(DELIVERY_FEE);
  deliveryLine.style.display = fee > 0 ? 'block' : 'none';
  deliveryLine.firstChild.textContent = (TEXT[lang].deliveryFee + ': ');
}

function setLang(l,b){
  lang=l;
  document.querySelectorAll('.langs .btn').forEach(x=>x.classList.remove('active'));
  b.classList.add('active');
  applyLang();
}

function applyLang(){
  btnDelivery.innerText=TEXT[lang].delivery;
  btnPickup.innerText=TEXT[lang].pickup;
  address.placeholder=TEXT[lang].address;
  phone.placeholder=TEXT[lang].phone;
  cartTitle.innerText=TEXT[lang].cart;
  orderBtn.innerText=TEXT[lang].order;
  comment.placeholder=TEXT[lang].comment;
  payCash.innerText=TEXT[lang].cash;
  payClick.innerText=TEXT[lang].click;
  searchTitle.innerText = TEXT[lang].results;
  popularTitle.innerText = TEXT[lang].popular;
  stickyCartBtn.innerText = TEXT[lang].cart;

  renderPopular();
  renderQuickFilters();
  renderProducts();
  updateTotal();
  updateTypeFields();

  setTimeout(setStickyHeight, 50);
}

function openCart(){
  try{ cartBox.scrollIntoView({behavior:'smooth', block:'start'}); }
  catch(_){ window.location.hash = '#cartBox'; }
}

function renderPopular(){
  popularRow.innerHTML = '';
  POPULAR.forEach((id)=>{
    const it = ITEM_INDEX[id];
    if(!it) return;
    cart[id]=cart[id]||0;

    popularRow.innerHTML += `
      <div class="pop-card" onclick="onPopularCardClick(event,'${id}')">
        <div class="pop-badge">üî•</div>
        <div class="pop-img"><img src="${it.img}" onerror="this.src='logo.png'"></div>
        <div class="pop-name">${escapeHtml(nameOf(id))}</div>
        <div class="pop-price">${formatSum(it.p)} <small>—Å—É–º</small></div>

        <div class="pop-counter">
          <button type="button" onclick="popChg(event,'${id}',-1)">‚àí</button>
          <span id="pc_${id}">${cart[id]||0}</span>
          <button type="button" onclick="popChg(event,'${id}',1)">+</button>
        </div>
      </div>
    `;
  });
}

function onPopularCardClick(e,id){
  if(e && e.target && (e.target.closest && e.target.closest('button'))) return;
  chg(id, 1);
  const pc = document.getElementById('pc_'+id);
  if(pc) pc.innerText = cart[id] || 0;
  if(isSearchOpen()) closeSearch();
}

function popChg(e,id,delta){
  if(e){ e.preventDefault(); e.stopPropagation(); }
  chg(id, delta);
  const pc = document.getElementById('pc_'+id);
  if(pc) pc.innerText = cart[id] || 0;
  if(isSearchOpen()) closeSearch();
}

/* quick filters = –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
function renderQuickFilters(){
  const keys = ['breakfast','second','first','shashlik','fish','salad','bread','drinks','preorder'];
  quickFilters.innerHTML = '';
  keys.forEach(k=>{
    if(!MENU[k]) return;
    const label = ({
      breakfast:{ru:'üç≥ –ó–∞–≤—Ç—Ä–∞–∫',uz:'üç≥ Nonushta',en:'üç≥ Breakfast'},
      first:{ru:'üçú –ü–µ—Ä–≤—ã–µ –±–ª—é–¥–∞',uz:'üçú Birinchi',en:'üçú First'},
      second:{ru:'üç≤ –í—Ç–æ—Ä—ã–µ –±–ª—é–¥–∞',uz:'üç≤ Ikkinchi',en:'üç≤ Main'},
      shashlik:{ru:'üî• –®–∞—à–ª—ã–∫',uz:'üî• Shashlik',en:'üî• Shashlik'},
      fish:{ru:'üêü –†—ã–±–Ω—ã–µ',uz:'üêü Baliq',en:'üêü Fish'},
      salad:{ru:'ü•ó –°–∞–ª–∞—Ç',uz:'ü•ó Salat',en:'ü•ó Salad'},
      bread:{ru:'ü•ñ –•–ª–µ–±',uz:'ü•ñ Non',en:'ü•ñ Bread'},
      drinks:{ru:'ü•§ –ù–∞–ø–∏—Ç–∫–∏',uz:'ü•§ Ichimlik',en:'ü•§ Drinks'},
      preorder:{ru:'üì¶ –ü–æ–¥ –∑–∞–∫–∞–∑',uz:'üì¶ Buyurtma',en:'üì¶ Pre-order'}
    })[k][lang] || k;

    quickFilters.innerHTML += `<button class="qbtn" onclick="pickCategory('${k}')">${label}</button>`;
  });
}

function pickCategory(k){
  if(isSearchOpen()) closeSearch();
  category = k;
  renderProducts();
}

function cardHTML(it, q=''){
  const id = it.id;
  const displayName = nameOf(id);
  const nameHtml = highlight(displayName, q);
  const qty = cart[id] || 0;

  return `<div class="card">
    <div class="img"><img src="${it.img}" onerror="this.src='logo.png'"></div>
    <div class="item-name">${nameHtml}</div>
    <div class="price">${formatSum(it.p)} <small>—Å—É–º</small></div>
    <div class="counter">
      <button onclick="chg('${id}',-1)">‚àí</button>
      <span id="c_${id}">${qty}</span>
      <button onclick="chg('${id}',1)">+</button>
    </div>
  </div>`;
}

function renderProducts(){
  products.innerHTML='';
  (MENU[category] || []).forEach((it)=>{
    cart[it.id]=cart[it.id]||0;
    products.innerHTML+=cardHTML(it,'');
  });
}

function syncPopularCounters(){
  POPULAR.forEach((id)=>{
    const el = document.getElementById('pc_'+id);
    if(el) el.innerText = cart[id] || 0;
  });
}

function chg(id,v){
  cart[id]=Math.max(0,(cart[id]||0)+v);
  const el = document.getElementById('c_'+id);
  if(el) el.innerText=cart[id];
  updateTotal();
  syncPopularCounters();
}

function price(id){
  return (ITEM_INDEX[id] && ITEM_INDEX[id].p) ? ITEM_INDEX[id].p : 0;
}

/* ‚úÖ total + –¥–æ—Å—Ç–∞–≤–∫–∞ */
function calcItemsSum(){
  let s=0;
  for(let id in cart) s += (cart[id]||0) * price(id);
  return s;
}

function updateTotal(){
  const itemsSum = calcItemsSum();
  const fee = getDeliveryFee();
  const grand = itemsSum + fee;

  total.innerText = formatSum(grand);
  stickyTotal.innerText = formatSum(grand);

  updateTypeFields();
}

function setType(t,b){
  if(isSearchOpen()) closeSearch();
  type=t;
  document.querySelectorAll('.types .btn').forEach(x=>x.classList.remove('active'));
  b.classList.add('active');
  updateTypeFields();
  updateTotal();
}

function setPayment(p){
  payment=p;
  payCash.classList.toggle('active',p==='cash');
  payClick.classList.toggle('active',p==='click');
}

function isSearchOpen(){ return searchWrap.classList.contains('show'); }

function toggleSearch(){
  if(isSearchOpen()) closeSearch();
  else openSearch();
}
function openSearch(){
  searchWrap.classList.add('show');
  searchTitle.classList.add('show');
  quickFilters.style.display = 'none';
  popularWrap.style.display = 'none';
  searchInput.value = '';
  searchInput.focus();
  searchProducts();
}
function closeSearch(){
  searchWrap.classList.remove('show');
  searchTitle.classList.remove('show');
  quickFilters.style.display = '';
  popularWrap.style.display = '';
  searchInput.value = '';
  renderProducts();
}
function clearSearch(){ closeSearch(); }

function onSearchKey(e){
  if(e.key === 'Enter') closeSearch();
}

function searchProducts(){
  const q = (searchInput.value || '').trim().toLowerCase();
  products.innerHTML='';

  if(!q){
    (MENU[category] || []).forEach((it)=>{
      cart[it.id]=cart[it.id]||0;
      products.innerHTML += cardHTML(it,'');
    });
    return;
  }

  for(let c in MENU){
    MENU[c].forEach((it)=>{
      const nmRu = (it.n && it.n.ru) ? String(it.n.ru).toLowerCase() : '';
      const nmUz = (it.n && it.n.uz) ? String(it.n.uz).toLowerCase() : '';
      const nmEn = (it.n && it.n.en) ? String(it.n.en).toLowerCase() : '';
      const nmCur = (it.n && it.n[lang]) ? String(it.n[lang]).toLowerCase() : '';

      if(nmCur.includes(q) || nmRu.includes(q) || nmUz.includes(q) || nmEn.includes(q)){
        cart[it.id]=cart[it.id]||0;
        products.innerHTML += cardHTML(it, q);
      }
    });
  }
}

document.addEventListener('click', (e)=>{
  if(!isSearchOpen()) return;
  const t = e.target;
  const insideSearch = searchWrap.contains(t) || searchTitle.contains(t);
  const onBtn = t.closest && t.closest('.search-btn');
  if(!insideSearch && !onBtn) closeSearch();
}, true);

function genOrderId(){
  const d = new Date();
  const dd = String(d.getDate()).padStart(2,'0');
  const mm = String(d.getMonth()+1).padStart(2,'0');
  const key = `orzu_dil_seq_${d.getFullYear()}${mm}${dd}`;

  let n = Number(localStorage.getItem(key) || 0) + 1;
  localStorage.setItem(key, String(n));

  const num = String(n).padStart(3,'0');
  return `ORZ-${dd}${mm}-${num}`;
}

function calcTotalNum(){
  return calcItemsSum() + getDeliveryFee();
}

function sendOrder(){
  popup.classList.add('show');

  const items = [];
  for (const id in cart) {
    const qty = Number(cart[id] || 0);
    if (qty > 0) {
      const it = ITEM_INDEX[id] || {};
      items.push({
        id,
        qty,
        price: it.p || 0,
        name_ru: (it.n && it.n.ru) ? it.n.ru : id,
        name_lang: nameOf(id)
      });
    }
  }

  if (items.length === 0) {
    popup.classList.remove('show');
    alert(TEXT[lang].empty);
    return;
  }

  const payload = {
    tg: { id: tg_id, username: tg_username, first_name: tg_first_name },
    items,
    total: total.innerText,
    total_num: calcTotalNum(),
    delivery_fee: getDeliveryFee(),
    payment,
    type,
    address: (type==='pickup' ? '' : address.value),
    phone: phone.value,
    comment: comment.value,
    order_id: genOrderId(),
    lang
  };

  setTimeout(()=>{
    Telegram.WebApp.sendData(JSON.stringify(payload));
    Telegram.WebApp.close();
  }, 700);
}

/* init defaults */
function setDefaultsUI(){
  // lang UZ already active in HTML
  // type pickup already active in HTML
  // apply placeholders and render
}
loadSaved();
bindSave();
applyLang();
updateTypeFields();
updateTotal();
</script>
</body>
</html>
